{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/auth.ts"],"sourcesContent":["import { SignJWT, jwtVerify } from 'jose';\r\n\r\nconst secret = new TextEncoder().encode(process.env.JWT_SECRET);\r\n\r\nexport async function signSession(payload: { userId: string; email: string }) {\r\n    const alg = 'HS256';\r\n    return new SignJWT(payload)\r\n        .setProtectedHeader({ alg })\r\n        .setIssuedAt()\r\n        .setExpirationTime('7d')\r\n        .sign(secret);\r\n}\r\n\r\nexport async function verifySession(token: string) {\r\n    try {\r\n        const { payload } = await jwtVerify(token, secret);\r\n        return payload;\r\n    } catch (error) {\r\n        return null;\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;;AAEA,MAAM,SAAS,IAAI,cAAc,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU;AAEvD,eAAe,YAAY,OAA0C;IACxE,MAAM,MAAM;IACZ,OAAO,IAAI,wKAAO,CAAC,SACd,kBAAkB,CAAC;QAAE;IAAI,GACzB,WAAW,GACX,iBAAiB,CAAC,MAClB,IAAI,CAAC;AACd;AAEO,eAAe,cAAc,KAAa;IAC7C,IAAI;QACA,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,4KAAS,EAAC,OAAO;QAC3C,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,OAAO;IACX;AACJ"}},
    {"offset": {"line": 44, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport type { NextRequest } from 'next/server';\r\nimport { verifySession } from './lib/auth';\r\n\r\nexport async function middleware(request: NextRequest) {\r\n    if (request.nextUrl.pathname.startsWith('/api') &&\r\n        !request.nextUrl.pathname.startsWith('/api/auth')) {\r\n\r\n        const token = request.cookies.get('session')?.value;\r\n\r\n        if (!token) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const session = await verifySession(token);\r\n        if (!session) {\r\n            return NextResponse.json({ error: 'Invalid Session' }, { status: 401 });\r\n        }\r\n\r\n        const requestHeaders = new Headers(request.headers);\r\n        requestHeaders.set('x-user-id', session.userId as string);\r\n\r\n        return NextResponse.next({\r\n            request: {\r\n                headers: requestHeaders,\r\n            },\r\n        });\r\n    }\r\n\r\n    return NextResponse.next();\r\n}\r\n\r\nexport const config = {\r\n    matcher: '/api/:path*',\r\n};\r\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAEA;;;AAEO,eAAe,WAAW,OAAoB;IACjD,IAAI,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,WACpC,CAAC,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,cAAc;QAEnD,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,YAAY;QAE9C,IAAI,CAAC,OAAO;YACR,OAAO,gMAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACtE;QAEA,MAAM,UAAU,MAAM,IAAA,oIAAa,EAAC;QACpC,IAAI,CAAC,SAAS;YACV,OAAO,gMAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkB,GAAG;gBAAE,QAAQ;YAAI;QACzE;QAEA,MAAM,iBAAiB,IAAI,QAAQ,QAAQ,OAAO;QAClD,eAAe,GAAG,CAAC,aAAa,QAAQ,MAAM;QAE9C,OAAO,gMAAY,CAAC,IAAI,CAAC;YACrB,SAAS;gBACL,SAAS;YACb;QACJ;IACJ;IAEA,OAAO,gMAAY,CAAC,IAAI;AAC5B;AAEO,MAAM,SAAS;IAClB,SAAS;AACb"}}]
}